<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bible Verse Creator</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:'Century Gothic', CenturyGothic, AppleGothic, 'Montserrat', sans-serif;
  background:#0d0d0d;
  color:white;
  display:flex;
  min-height:100vh;
}

/* SIDEBAR */
.sidebar{
  width:72px;
  background:#111;
  border-right:1px solid #222;
  transition:.35s ease;
  display:flex;
  flex-direction:column;
  padding:18px 0;
}
.sidebar:hover{width:240px}
.sidebar button{
  background:none;
  border:none;
  color:white;
  padding:14px 16px;
  display:flex;
  gap:12px;
  align-items:center;
  cursor:pointer;
  font-size:15px;
  transition:.25s;
}
.sidebar button:hover{background:#1a1a1a}
.sidebar span{opacity:0;white-space:nowrap;transition:.3s}
.sidebar:hover span{opacity:1}

/* MAIN */
main{flex:1;padding:24px}
header{
  background:#181818;
  padding:16px;
  border-radius:14px;
  text-align:center;
  margin-bottom:24px;
}
header h1{
  color:#ffd700;
  letter-spacing:1px;
  font-weight:700;
}

/* CANVAS */
.canvas-wrapper{
  max-width:960px;
  margin:auto;
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 25px 60px rgba(0,0,0,.6);
}
#container{
  position:relative;
  width:100%;
  padding-bottom:56.25%;
  background:#000 center/cover no-repeat;
}
#verso,#referencia{
  position:absolute;
  text-shadow:2px 4px 14px rgba(0,0,0,.85);
}
#verso{
  top:10%;
  left:6%;
  font-size:34px;
  max-width:88%;
  line-height:1.45;
  font-weight:600;
}
#referencia{
  bottom:9%;
  left:6%;
  font-size:20px;
  opacity:.9;
}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:10;
}
.modal-content{
  background:#181818;
  padding:22px;
  border-radius:16px;
  width:380px;
  max-height:85vh;
  overflow-y:auto;
  position:relative;
}
.modal-content h3{
  color:#ffd700;
  margin-bottom:12px;
  text-align:center;
}
.modal-content input,
.modal-content select,
.modal-content button{
  width:100%;
  padding:10px;
  margin:7px 0;
  background:#222;
  border:none;
  border-radius:10px;
  color:white;
}
.modal-content button{
  font-weight:600;
  cursor:pointer;
}
.modal-content button:hover{background:#333}

.btn-fechar{
  position:absolute;
  top:12px;
  right:14px;
  background:none;
  border:none;
  color:#aaa;
  font-size:20px;
  cursor:pointer;
}
.btn-fechar:hover{color:#fff}

.resultado{
  padding:10px;
  background:#222;
  border-radius:10px;
  margin-bottom:8px;
  cursor:pointer;
  font-size:.85rem;
}
.resultado:hover{background:#333}

mark{background:none;font-weight:800}
</style>
</head>

<body>

<div class="sidebar">
  <button onclick="openModal('mBuscar')">üìñ <span>Buscar</span></button>
  <button onclick="openModal('mTexto')">‚úçÔ∏è <span>Texto</span></button>
  <button onclick="openModal('mPosicao')">üìê <span>Posi√ß√£o</span></button>
  <button onclick="openModal('mFundo')">üñº <span>Fundo</span></button>
  <button onclick="toggleRef()">üëÅ <span>Refer√™ncia</span></button>
  <button onclick="baixarImagem()">üì∏ <span>Baixar</span></button>
</div>

<main>
<header><h1>BIBLE OFICIAL</h1></header>

<div class="canvas-wrapper">
  <div id="container">
    <div id="verso">Selecione um vers√≠culo...</div>
    <div id="referencia"></div>
  </div>
</div>
</main>

<!-- BUSCAR -->
<div class="modal" id="mBuscar">
  <div class="modal-content">
    <button class="btn-fechar" onclick="closeModal()">‚úñ</button>
    <h3>Buscar Vers√≠culo</h3>

    <input id="buscaPalavra" placeholder="Palavra ou frase">
    <button onclick="buscarPorPalavra()">Buscar Palavra</button>

    <select id="livro"></select>
    <select id="capitulo"></select>
    <select id="versiculo"></select>
    <button onclick="buscarVersiculo()">Buscar Refer√™ncia</button>

    <div id="listaResultados"></div>
  </div>
</div>

<!-- TEXTO -->
<div class="modal" id="mTexto">
  <div class="modal-content">
    <button class="btn-fechar" onclick="closeModal()">‚úñ</button>
    <h3>Texto</h3>

    <label>Tamanho Verso</label>
    <input type="range" id="tamanhoVerso" min="18" max="72" value="34">

    <label>Tamanho Refer√™ncia</label>
    <input type="range" id="tamanhoRef" min="12" max="48" value="20">

    <label>Cor Verso</label>
    <input type="color" id="corVerso" value="#ffffff">

    <label>Destaque</label>
    <input id="textoDestaque" placeholder="Ex: SENHOR, descanso">
    <input type="color" id="corDestaque" value="#ffd700">
    <button onclick="aplicarDestaques()">Aplicar</button>
  </div>
</div>

<!-- POSI√á√ÉO -->
<div class="modal" id="mPosicao">
  <div class="modal-content">
    <button class="btn-fechar" onclick="closeModal()">‚úñ</button>
    <h3>Posi√ß√£o</h3>
    <input type="range" id="posicaoVerso" min="0" max="80" value="10">
    <input type="range" id="posicaoVersoH" min="0" max="90" value="6">
  </div>
</div>

<!-- FUNDO -->
<div class="modal" id="mFundo">
  <div class="modal-content">
    <button class="btn-fechar" onclick="closeModal()">‚úñ</button>
    <h3>Fundo</h3>
    <input type="file" id="uploadFundo">
  </div>
</div>

<script>
let biblia=[], textoOriginal="";
const livro=document.getElementById("livro");
const capitulo=document.getElementById("capitulo");
const versiculo=document.getElementById("versiculo");
const versoEl=document.getElementById("verso");
const refEl=document.getElementById("referencia");
const lista=document.getElementById("listaResultados");
const container=document.getElementById("container");

fetch("bible_acf.json")
.then(r=>r.json())
.then(d=>{biblia=d;init();});

function init(){
  biblia.forEach((b,i)=>livro.innerHTML+=`<option value="${i}">${b.name}</option>`);
  livro.onchange=loadCaps;
  capitulo.onchange=loadVers;
  loadCaps();
}

function loadCaps(){
  capitulo.innerHTML="";
  biblia[livro.value].chapters.forEach((_,i)=>
    capitulo.innerHTML+=`<option value="${i}">${i+1}</option>`
  );
  loadVers();
}

function loadVers(){
  versiculo.innerHTML="";
  biblia[livro.value].chapters[capitulo.value].forEach((_,i)=>
    versiculo.innerHTML+=`<option value="${i}">${i+1}</option>`
  );
}

function buscarVersiculo(){
  const b=biblia[livro.value];
  textoOriginal=b.chapters[capitulo.value][versiculo.value].toUpperCase();
  versoEl.innerText=textoOriginal;
  refEl.innerText=`${b.name.toUpperCase()} ${+capitulo.value+1}:${+versiculo.value+1}`;
  closeModal();
}

function normalizar(t){
  return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");
}

function buscarPorPalavra(){
  lista.innerHTML="";
  const termo=normalizar(buscaPalavra.value);
  if(!termo) return;

  biblia.forEach(b=>{
    b.chapters.forEach((c,i)=>{
      c.forEach((t,v)=>{
        if(normalizar(t).includes(termo)){
          const d=document.createElement("div");
          d.className="resultado";
          d.innerHTML=`<b>${b.name} ${i+1}:${v+1}</b><br>${t}`;
          d.onclick=()=>{
            textoOriginal=t.toUpperCase();
            versoEl.innerText=textoOriginal;
            refEl.innerText=`${b.name.toUpperCase()} ${i+1}:${v+1}`;
            closeModal();
          }
          lista.appendChild(d);
        }
      });
    });
  });
}

tamanhoVerso.oninput=e=>versoEl.style.fontSize=e.target.value+"px";
tamanhoRef.oninput=e=>refEl.style.fontSize=e.target.value+"px";
corVerso.oninput=e=>versoEl.style.color=e.target.value;
posicaoVerso.oninput=e=>versoEl.style.top=e.target.value+"%";
posicaoVersoH.oninput=e=>versoEl.style.left=e.target.value+"%";

function aplicarDestaques(){
  let t=textoOriginal;
  textoDestaque.value.split(",").forEach(p=>{
    p=p.trim();
    if(p) t=t.replace(new RegExp(`(${p})`,"gi"),
      `<mark style="color:${corDestaque.value}">$1</mark>`);
  });
  versoEl.innerHTML=t;
}

uploadFundo.onchange=e=>{
  const r=new FileReader();
  r.onload=()=>container.style.backgroundImage=`url('${r.result}')`;
  r.readAsDataURL(e.target.files[0]);
};

function openModal(id){document.getElementById(id).style.display="flex";}
function closeModal(){document.querySelectorAll(".modal").forEach(m=>m.style.display="none");}
function toggleRef(){refEl.style.display=refEl.style.display=="none"?"block":"none";}
function baixarImagem(){
  html2canvas(container).then(c=>{
    const a=document.createElement("a");
    a.href=c.toDataURL("image/png");
    a.download="versiculo.png";
    a.click();
  });
}
</script>

</body>
</html>
